<html>
<head>
	<title>Mazama Cameras</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<link rel="apple-touch-icon" href="goat.png">
	<link rel="icon" href="goat.png">
	<style>
		body {
			background-color: #444444;
			font-family: -apple-system,Helvetica,sans-serif;
		}
		.pageTitle {
			font-size: 30px;
			color: #fc6f03;
			font-variant-caps: all-small-caps;
			margin: 0px;
		}
		.cams {
			margin: auto; /* centers content on page */
			max-width: 900px;
		}
		.cams img {
			height: auto;
			max-width: 100%;
			padding-top: 5px;
			padding-bottom: 10px;
		}
		.fixed_width {
			width: 350px;
			height: auto;
		}
		.cams a {
			color: #fc6f03;
			font-size: 15px;
			font-variant-caps: all-small-caps;
			text-decoration: none;
		}
		/* minimal formatting for the temperature line */
		.tempLine {
			color: #fc6f03;
			font-size: 18px;
			margin: 0 0 8px 0;
		}
	</style>
</head>
<body>
	<div class="cams">
	<!-- <p class="pageTitle">Mazama Cameras</p> -->

	<!-- Temperature: fetch from latest-weather.json, convert to °F, show local timestamp -->
	<script type="text/javascript">
		(async function () {
			const container = document.querySelector('.cams');
			const tempEl = document.createElement('p');
			tempEl.id = 'temperature';
			tempEl.className = 'tempLine';
			tempEl.textContent = 'Loading temperature...';
			container.insertBefore(tempEl, container.firstChild);

			function toFahrenheit(celsius) {
				return (celsius * 9 / 5) + 32;
			}

			try {
				const resp = await fetch('latest-weather.json');
				if (!resp.ok) throw new Error('Network response was not ok');
				const data = await resp.json();

				const tempVal = data?.properties?.temperature?.value;
				const unitCode = data?.properties?.temperature?.unitCode || '';
				const timestampStr = data?.properties?.timestamp;

				let tempF = null;
				if (tempVal === null || tempVal === undefined || Number.isNaN(Number(tempVal))) {
					tempEl.textContent = 'Temperature: N/A';
					return;
				} else {
					if (unitCode && unitCode.toLowerCase().includes('degf')) {
						tempF = Number(tempVal);
					} else {
						tempF = toFahrenheit(Number(tempVal));
					}
				}

				const roundedF = Math.round(tempF * 10) / 10;

				let localTime = 'time unavailable';
				if (timestampStr) {
					const d = new Date(timestampStr);
					if (!isNaN(d.getTime())) {
						try {
							localTime = d.toLocaleString(undefined, { dateStyle: 'medium', timeStyle: 'short' });
						} catch (e) {
							localTime = d.toLocaleString();
						}
					}
				}

				tempEl.textContent = 'Temperature: ' + roundedF + ' °F — ' + localTime;
			} catch (err) {
				console.error('Failed to load temperature:', err);
				tempEl.textContent = 'Temperature: unavailable';
			}
		})();
	</script>

	<script type="text/javascript">

		//Mazama Ranch House		
		document.write('<a href="https://mazamaranchhouse.com/webcam" target="_blank">');
		document.write('<img src="https://mazamacam.earthandskystudios.com/content/ranchhouseimg.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

		//Edelweiss		
		//document.write('<a href="http://highlandmeadow.homelinux.org" target="_blank">');
		//document.write('<img src="http://highlandmeadow.homelinux.org' + '?' + Math.random() + '" />');
		//document.write('</a></br>');

		//Sun Mountain		
		document.write('<a href="https://sunmountainlodge.com/webcam" target="_blank">');
		document.write('<img src="https://sunmountainlodge.com/wp-content/uploads/webcam/smlcam.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

		//Mazama Snow Stake
		document.write('<a href="https://stake-images.sfo3.digitaloceanspaces.com/mazama/latest/stake_image.jpg" target="_blank">');
		document.write('<img class="fixed_width" src="https://stake-images.sfo3.digitaloceanspaces.com/mazama/latest/stake_image.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

		//Winthrop		
		//document.write('<a href="https://wsdot.com/travel/real-time/weather/4332" target="_blank">');
		document.write('<a href="https://wsdot.com/travel/real-time/mountainpasses/north-cascade-hwy" target="_blank">');
		document.write('<img class="fixed_width" src="https://images.wsdot.wa.gov/nc/020vc19255.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

		//Loup Loup Pass		
		document.write('<a href="https://wsdot.com/travel/real-time/mountainpasses/Loup-Loup" target="_blank">');
		document.write('<img class="fixed_width" src="https://images.wsdot.wa.gov/nc/020vc21450.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

		//Snoqualmie Pass		
		document.write('<a href="https://wsdot.com/travel/real-time/mountainpasses/Snoqualmie" target="_blank">');
		document.write('<img class="fixed_width" src="https://images.wsdot.wa.gov/sc/090VC05200.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

		//Blewett Pass		
		document.write('<a href="https://wsdot.com/travel/real-time/mountainpasses/Blewett" target="_blank">');
		document.write('<img class="fixed_width" src="https://images.wsdot.wa.gov/nc/097vc16375.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

		//Stevens Pass		
		document.write('<a href="https://wsdot.com/travel/real-time/mountainpasses/Stevens" target="_blank">');
		document.write('<img class="fixed_width" src="https://images.wsdot.wa.gov/nc/002vc06458.jpg' + '?' + Math.random() + '" />');
		document.write('</a></br>');

	</script>
	</div>
</body>
</html>
